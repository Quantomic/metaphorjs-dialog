'use strict';define("metaphorjs-dialog","metaphorjs-observable metaphorjs-promise metaphorjs-ajax metaphorjs-select metaphorjs-animate metaphorjs-namespace metaphorjs-class".split(" "),function(ja,ba,ka,t,W,u,x){function X(a){return"object"==typeof a&&3===P(a)&&!a.nodeType&&a.constructor===Object}function Q(a){return!0===a||!1===a}function ca(a,b){return b?da("(?:^|\\s)"+b+"(?!\\S)").test(a.className):!1}function H(a,b){b&&!ca(a,b)&&(a.className+=" "+b)}function Y(a,b){b&&(a.className=a.className.replace(da("(?:^|\\s)"+
b+"(?!\\S)"),""))}function q(a,b,c){if(a){var d=a.style,g;"string"==typeof b?(a={},a[b]=c):a=b;for(g in a)d[g]=a[g]}}function L(a,b){return a.getAttribute?a.getAttribute(b):null}function R(){return!1}function S(){return!0}function y(a){return new O(a)}function B(a){return"string"==typeof a||a===""+a}function E(a){return"function"==typeof a}function F(a){return a.substr(0,1).toUpperCase()+a.substr(1)}function la(a,b,c,d){var g=b+"-"+c,f=function(a){a=y(a);return Z(a.target,b)?d(a):null};T[g]||(T[g]=
[]);T[g].push({el:a,ls:f,fn:d});A(a,c,f)}function ma(a,b,c,d){var g,f;if(f=T[b+"-"+c])for(b=-1,g=f.length;++b<g;)f[b].el===a&&f[b].fn===d&&C(a,c,f[b].ls)}function M(a,b,c,d){return setTimeout(function(){a.apply(b,c||[])},d||0)}function I(a){var b={top:0,left:0},c=window.document.documentElement;if(!na(a)||a===window)return b;a.getBoundingClientRect&&(b=a.getBoundingClientRect());return{top:b.top+$()-c.clientTop,left:b.left+aa()-c.clientLeft}}var ea=W.stop,fa={};u=new u(fa,"MetaphorJs");x=new x(u);
var r=x.define,N=x.factory,ga=Array.prototype.slice,oa=Object.prototype.toString,P=function(){var a={"[object String]":0,"[object Number]":1,"[object Boolean]":2,"[object Object]":3,"[object Function]":4,"[object Array]":5,"[object RegExp]":9,"[object Date]":10};return function(b){if(!b){if(null===b)return 6;if(void 0===b)return 7}var c=a[oa.call(b)];return void 0===c?-1:1==c&&isNaN(b)?8:c}}(),J=function(){return function b(){var c=!1,d=!1,g=ga.call(arguments),f=g.shift(),h,k,e;Q(g[g.length-1])&&
(c=g.pop());Q(g[g.length-1])&&(d=c,c=g.pop());for(;g.length;)if(h=g.shift())for(k in h)if(h.hasOwnProperty(k)&&void 0!==(e=h[k]))if(d)if(f[k]&&X(f[k])&&X(e))b(f[k],e,c,d);else{if(!0===c||void 0==f[k])X(e)?(f[k]={},b(f[k],e,c,!0)):f[k]=e}else if(!0===c||void 0==f[k])f[k]=e;return f}}(),ha=function(){var a=["0","0","0"];return function(){for(var b=a.length,c;b;){b--;c=a[b].charCodeAt(0);if(57==c)return a[b]="A",a.join("");if(90==c)a[b]="0";else return a[b]=String.fromCharCode(c+1),a.join("")}a.unshift("0");
return a.join("")}}(),w=Function.prototype.bind?function(a,b){return a.bind(b)}:function(a,b){return function(){return a.apply(b,arguments)}},da=function(){var a={};return function(b){return a[b]||(a[b]=new RegExp(b))}}(),D=function(){var a={};return function(b,c,d){b=b._mjsid||(b._mjsid=ha());var g=a[b];return void 0!==d?(g||(g=a[b]={}),g[c]=d):g?g[c]:void 0}}(),O=function(a){if(a instanceof O)return a;if(!(this instanceof O))return new O(a);for(var b in a)if(!this[b])try{this[b]=a[b]}catch(c){}this.originalEvent=
a;this.type=a.type;!this.target&&a.srcElement&&(this.target=a.srcElement);var d,g=a.button;void 0===this.pageX&&null!==a.clientX&&(d=this.target?this.target.ownerDocument||window.document:window.document,b=d.documentElement,d=d.body,this.pageX=a.clientX+(b&&b.scrollLeft||d&&d.scrollLeft||0)-(b&&b.clientLeft||d&&d.clientLeft||0),this.pageY=a.clientY+(b&&b.scrollTop||d&&d.scrollTop||0)-(b&&b.clientTop||d&&d.clientTop||0));this.which||void 0===g||(this.which=g&1?1:g&2?3:g&4?2:0);this.isDefaultPrevented=
a.defaultPrevented||void 0===a.defaultPrevented&&!1===a.returnValue?S:R;this.timeStamp=a&&a.timeStamp||(new Date).getTime()};J(O.prototype,{isDefaultPrevented:R,isPropagationStopped:R,isImmediatePropagationStopped:R,preventDefault:function(){var a=this.originalEvent;this.isDefaultPrevented=S;a.returnValue=!1;a&&a.preventDefault&&a.preventDefault()},stopPropagation:function(){var a=this.originalEvent;this.isPropagationStopped=S;a&&a.stopPropagation&&a.stopPropagation()},stopImmediatePropagation:function(){var a=
this.originalEvent;this.isImmediatePropagationStopped=S;a&&a.stopImmediatePropagation&&a.stopImmediatePropagation();this.stopPropagation()}},!0,!1);var ia=function(a){function b(){d=null}var c,d;a=function(a){return function(f){var h=y(f||window.event),k=ga.call(arguments,1),e=0,l=0,m=0,n=0,p=0,v=0;h.type="mousewheel";"detail"in h&&(m=-1*h.detail);"wheelDelta"in h&&(m=h.wheelDelta);"wheelDeltaY"in h&&(m=h.wheelDeltaY);"wheelDeltaX"in h&&(l=-1*h.wheelDeltaX);"axis"in h&&h.axis===h.HORIZONTAL_AXIS&&
(l=-1*m,m=0);e=0===m?l:m;"deltaY"in h&&(e=m=-1*h.deltaY);"deltaX"in h&&(l=h.deltaX,0===m&&(e=-1*l));if(0!==m||0!==l){n=Math.max(Math.abs(m),Math.abs(l));if(!d||n<d)d=n,"mousewheel"===h.type&&0===n%120&&(d/=40);"mousewheel"===h.type&&0===n%120&&(e/=40,l/=40,m/=40);e=Math[1<=e?"floor":"ceil"](e/d);l=Math[1<=l?"floor":"ceil"](l/d);m=Math[1<=m?"floor":"ceil"](m/d);this.getBoundingClientRect&&(n=this.getBoundingClientRect(),p=h.clientX-n.left,v=h.clientY-n.top);h.deltaX=l;h.deltaY=m;h.deltaFactor=d;h.offsetX=
p;h.offsetY=v;h.deltaMode=0;k.unshift(h,e,l,m);c&&clearTimeout(c);c=setTimeout(b,200);return a.apply(this,k)}}};a.events=function(){var a=window.document;return"onwheel"in a||9<=a.documentMode?["wheel"]:["mousewheel","DomMouseScroll","MozMousePixelScroll"]};return a}(),A=function(){var a=null,b=null;return function(c,d,g){null===a&&(a=c.attachEvent?"attachEvent":"addEventListener",b=c.attachEvent?"on":"");if("mousewheel"==d){g=ia(g);d=ia.events();var f,h;f=0;for(h=d.length;f<h;f++)c[a](b+d[f],g,!1)}else c[a](b+
d,g,!1);return g}}(),C=function(){var a=null,b=null;return function(c,d,g){null===a&&(a=c.detachEvent?"detachEvent":"removeEventListener",b=c.detachEvent?"on":"");c[a](b+d,g)}}(),Z=t.is,K=function(a,b,c){if(window.getComputedStyle){if(a===window)return b?c?0:null:{};a=getComputedStyle(a,null)}else a=a.currentStyle||a.style||{};b=b?a[b]:a;return c?parseFloat(b)||0:b},pa=function(){var a;return function(){if(void 0===a){var b=window.document,c=b.createElement("div"),d=b.createElement("div"),b=b.body;
d.style&&window.getComputedStyle?(c.style.cssText="border:0;width:0;height:0;top:0;left:-9999px;margin-top:1px;position:absolute",c.appendChild(d),d.style.cssText="-webkit-box-sizing:border-box;-moz-box-sizing:border-box;box-sizing:border-box;display:block;margin-top:1%;top:1%;border:1px;padding:1px;width:4px;position:absolute",d.innerHTML="",b.appendChild(c),d="4px"===window.getComputedStyle(d,null).width,b.removeChild(c),a=d):a=!1}return a}}();x=function(a,b){var c=/^([+-]?(?:d*.|)d+(?:[eE][+-]?d+|))(?!px)[a-z%]+$/i,
d=["Top","Right","Bottom","Left"],g=a?"inner"==a?"padding":"":"content";return function(a,h){if(a===window)return a.document.documentElement["client"+b];if(9===a.nodeType){var k=a.documentElement;return Math.max(a.body["scroll"+b],k["scroll"+b],a.body["offset"+b],k["offset"+b],k["client"+b])}a:{var e=b.toLowerCase(),l=g||(!0===h?"margin":"border"),k=K(a),m=!0,n="width"===e?a.offsetWidth:a.offsetHeight,p="border-box"===k.boxSizing;if(0>=n||null==n){n=a.style[e];if(c.test(n)){k=n;break a}m=p&&(pa()||
n===a.style[e]);n=parseFloat(n)||0}l=l||(p?"border":"content");e=l===(m?"border":"content")?4:"width"===e?1:0;for(p=0;4>e;e+=2)"margin"===l&&(p+=parseFloat(k[l+d[e]])),m?("content"===l&&(p-=parseFloat(k["padding"+d[e]])),"margin"!==l&&(p-=parseFloat(k["border"+d[e]+"Width"]))):(p+=parseFloat(k["padding"+d[e]]),"padding"!==l&&(p+=parseFloat(k["border"+d[e]+"Width"])));k=n+p}return k}};var U=x("outer","Width"),V=x("outer","Height"),T={},G=function(){var a,b;if("undefined"!=typeof window){var c=window;
a=c.requestAnimationFrame||c.webkitRequestAnimationFrame||c.mozRequestAnimationFrame;b=c.cancelAnimationFrame||c.webkitCancelAnimationFrame||c.mozCancelAnimationFrame||c.webkitCancelRequestAnimationFrame;if(a)return function(c){var g=a(c);return function(){b(g)}}}return function(a){var b=setTimeout(a,0);return function(){clearTimeout(b)}}}();u.register("mixin.Observable",{$$observable:null,$$callbackContext:null,$beforeInit:function(a){this.$$observable=new ja;if(a&&a.callback){var b=a.callback,c=
b.context||b.scope,d;b.context=null;b.scope=null;for(d in b)if(b[d])this.$$observable.on(d,b[d],c||this);a.callback=null;c&&(this.$$callbackContext=c)}},on:function(){var a=this.$$observable;return a.on.apply(a,arguments)},un:function(){var a=this.$$observable;return a.un.apply(a,arguments)},once:function(){var a=this.$$observable;return a.once.apply(a,arguments)},trigger:function(){var a=this.$$observable;return a.trigger.apply(a,arguments)},$beforeDestroy:function(){this.$$observable.trigger("before-destroy",
this)},$afterDestroy:function(){this.$$observable.trigger("destroy",this);this.$$observable.destroy();this.$$observable=null}});u=function(a){var b,c=a?"pageYOffset":"pageXOffset",d=a?"scrollTop":"scrollLeft";a=window.document;var g=a.body,f=a.documentElement;b=void 0!==window[c]?function(){return window[c]}:f.clientHeight?function(){return f[d]}:function(){return g[d]};return function(a){return a&&a!==window?a&&1==a.nodeType&&a!==g&&a!==f?a[d]:b():b()}};var $=u(!0),aa=u(!1),qa=x("","Width"),ra=x("",
"Height");r({$class:"dialog.position.Abstract",dialog:null,positionBase:null,correct:"solid",$init:function(a){this.dialog=a;J(this,a.getCfg().position,!0,!1);this.onWindowResizeDelegate=w(this.onWindowResize,this);this.onWindowScrollDelegate=w(this.onWindowScroll,this);var b=this.preferredType||this.type;if("string"==typeof b){var c=this.getAllPositions(),d;-1!=(d=c.indexOf(b))&&(c.splice(d,1),c.unshift(b));this.preferredType=c}else b||(this.preferredType=this.getAllPositions());a.on("reposition",
this.onReposition,this);a.on("show-after-delay",this.onShowAfterDelay,this);a.on("hide-after-delay",this.onHideAfterDelay,this);if(a.isVisible())this.onShowAfterDelay()},getPositionBase:function(){if(this.positionBase)return this.positionBase;var a;return(a=this.dialog.getCfg().position.base)?this.positionBase="string"==typeof a?t(a).shift():a:null},getBoundary:function(){var a=this.getPositionBase(),b=this.screenX||0,c=this.screenY||0,d,g,f;if(a)return g=I(a),d=U(a),a=V(a),{x:g.left+b,y:g.top+c,
x1:g.left+d-b,y1:g.top+a-c,w:d,h:a};d=qa(window);a=ra(window);g=$(window);f=aa(window);return{x:f+b,y:g+c,x1:f+d-b,y1:g+a-c,w:d,h:a}},getPrimaryPosition:function(a){return!1},getSecondaryPosition:function(a){return!1},getAllPositions:function(){return[]},correctPosition:function(a){var b=this.getPrimaryPosition(),c=this.correct;if(b&&c){var d=this.dialog,b=this.getBoundary(),d=d.getDialogSize(),g=this.preferredType,f=g[0];if(c&&"solid"!=c){if(this.type!=f&&this.checkIfFits(a,f,b,d,!1))return this.changeType(f),
this.fitToBoundary(this.getCoords(a),b,d);if(this.checkIfFits(a,this.type,b,d,!1))return this.fitToBoundary(this.getCoords(a),b,d)}if(c&&"position-only"!=c)for(c=0,f=g.length;c<f;c++)if(this.checkIfFits(a,g[c],b,d,!0)){this.changeType(g[c]);break}return this.getCoords(a)}},checkIfFits:function(a,b,c,d,g){a=this.getCoords(a,b,!0);if(!g&&this.getSecondaryPosition(b))return!1;if(g)return!(a.x<c.x||a.y<c.y||a.x+d.width>c.x1||a.y+d.height>c.y1);switch(this.getPrimaryPosition(b)){case "t":return a.y>=c.y;
case "r":return a.x+d.width<=c.x1;case "b":return a.y+d.height<=c.y1;case "l":return a.x>=c.x}},fitToBoundary:function(a,b,c){var d=this.getPositionBase(),g=d?0:b.x,f=d?0:b.y,h=d?b.w:b.x1;b=d?b.h:b.y1;var k=d=0,e=this.dialog.getPointer();a.x<g&&(d=a.x-g,a.x=g);a.y<f&&(k=a.y-f,a.y=f);a.x+c.width>h&&(d=a.x+c.width-h,a.x-=d);a.y+c.height>b&&(k=a.y+c.height-b,a.y-=k);e.setCorrectionOffset(d,k);e.reposition();return a},changeType:function(a){var b=this.dialog.getPointer();this.type=a;b.setType(null,null)},
onReposition:function(a,b){var c;c=!1!==this.screenX||!1!==this.screenY?this.correctPosition(b):this.getCoords(b);this.apply(c)},getCoords:function(a){return{left:0,top:0}},apply:function(a){a&&q(this.dialog.getElem(),{left:a.x+"px",top:a.y+"px"})},onWindowResize:function(a){this.dialog.reposition(y(a))},onWindowScroll:function(a){this.dialog.reposition(y(a))},onShowAfterDelay:function(){(this.resize||this.screenX||this.screenY)&&A(window,"resize",this.onWindowResizeDelegate);(this.scroll||this.screenX||
this.screenY)&&A(this.dialog.getScrollEl(this.scroll),"scroll",this.onWindowScrollDelegate)},onHideAfterDelay:function(){(this.resize||this.screenX||this.screenY)&&C(window,"resize",this.onWindowResizeDelegate);(this.scroll||this.screenX||this.screenY)&&C(this.dialog.getScrollEl(this.scroll),"scroll",this.onWindowScrollDelegate)},destroy:function(){var a=this.dialog;a.un("reposition",this.onReposition,this);a.un("show-after-delay",this.onShowAfterDelay,this);a.un("hide-after-delay",this.onHideAfterDelay,
this);if(this.dialog.isVisible())this.onHideAfterDelay()}});var na=function(){return function b(c){if(c===window)return!0;if(3==c.nodeType)return c.parentElement?b(c.parentElement):!0;var d=window.document.documentElement;return c===d?!0:d.contains(c)}}();r({$class:"dialog.position.Target",$extends:"dialog.position.Abstract",getCoords:function(a,b,c){var d=this.dialog,g=d.getCfg(),f=d.getTarget();if(!f)return null;var h=this.getPositionBase();a=d.getDialogSize();if(h&&!c)a:{var k;c={top:0,left:0};
var e=window.document.documentElement;if(f===window||f===e)f=c;else{if("fixed"==K(f,"position"))k=f.getBoundingClientRect();else if(h){f=I(f);c=I(h);f={left:f.left-c.left,top:f.top-c.top};0>f.left&&(f.left=0);0>f.top&&(f.top=0);break a}else{h=window.document.documentElement;for(k=f.offsetParent||h;k&&k!=h&&"static"==K(k,"position");)k=k.offsetParent;h=k||h;k=I(f);h!==e&&(c=I(h));c.top+=K(h,"borderTopWidth",!0);c.left+=K(h,"borderLeftWidth",!0)}f={top:k.top-c.top-K(f,"marginTop",!0),left:k.left-c.left-
K(f,"marginLeft",!0)}}}else f=I(f);c=d.getTargetSize();e={};b=b||this.type;h=b.substr(0,1);k=b.substr(1);var l=g.position.offsetX,g=g.position.offsetY;b=d.pointer.getDialogPositionOffset(b);switch(h){case "t":e.y=f.top-a.height-g;break;case "r":e.x=f.left+c.width+l;break;case "b":e.y=f.top+c.height+g;break;case "l":e.x=f.left-a.width-l}switch(k){case "t":e.y=f.top+g;break;case "r":e.x=f.left+c.width-a.width-l;break;case "b":e.y=f.top+c.height-a.height-g;break;case "l":e.x=f.left+l;break;case "rc":e.x=
f.left+c.width+l;break;case "lc":e.x=f.left-a.width-l;break;case "":switch(h){case "t":case "b":e.x=f.left+c.width/2-a.width/2;break;case "r":case "l":e.y=f.top+c.height/2-a.height/2}}b&&(e.x+=b.x,e.y+=b.y);return e},getPrimaryPosition:function(a){return(a||this.type).substr(0,1)},getSecondaryPosition:function(a){return(a||this.type).substr(1)},getAllPositions:function(){return"t r b l tl tr rt rb br bl lb lt tlc trc brc blc".split(" ")}});r({$class:"dialog.position.Mouse",$extends:"dialog.position.Target",
correct:"position",$init:function(a){this.onMouseMoveDelegate=w(this.onMouseMove,this);this.$super(a)},getCoords:function(a,b,c){if(!a)return null;var d=b||this.type,g=this.dialog,f=g.getCfg(),h=g.getDialogSize(),k=this.getPositionBase(),e={};b=(b||this.type).substr(1);var l=f.position.offsetX,m=f.position.offsetY,f=f.position.axis,d=g.getPointer().getDialogPositionOffset(d),n=0,p=0;!c&&k&&(k=I(k),n=k.left,p=k.top);switch(b){case "":e=this.get.call(g.$$callbackContext,g,a,b,c);break;case "c":e.y=
a.pageY-p-h.height/2;e.x=a.pageX-n-h.width/2;break;case "t":e.y=a.pageY-p-h.height-m;e.x=a.pageX-n-h.width/2;break;case "r":e.y=a.pageY-p-h.height/2;e.x=a.pageX-n+l;break;case "b":e.y=a.pageY-p+m;e.x=a.pageX-n-h.width/2;break;case "l":e.y=a.pageY-p-h.height/2;e.x=a.pageX-n-h.width-l;break;case "rt":e.y=a.pageY-p-h.height-m;e.x=a.pageX-n+l;break;case "rb":e.y=a.pageY-p+m;e.x=a.pageX-n+l;break;case "lt":e.y=a.pageY-p-h.height-m;e.x=a.pageX-n-h.width-l;break;case "lb":e.y=a.pageY-p+m,e.x=a.pageX-n-h.width-
l}d&&(e.x+=d.x,e.y+=d.y);f&&(a=this.$super(a,b))&&("x"==f?e.y=a.y:e.x=a.x);return e},onShowAfterDelay:function(){this.$super();A(window.document.documentElement,"mousemove",this.onMouseMoveDelegate)},onHideAfterDelay:function(){this.$super();C(window.document.documentElement,"mousemove",this.onMouseMoveDelegate)},onMouseMove:function(a){this.dialog.reposition(y(a))},getPrimaryPosition:function(a){return(a||this.type).substr(1,1)},getSecondaryPosition:function(a){return(a||this.type).substr(2)},getAllPositions:function(){return"mt mr mb ml mrt mrb mlb mlt".split(" ")}});
r({$class:"dialog.position.Window",$extends:"dialog.position.Abstract",getCoords:function(a){var b=this.dialog;a=this.getPositionBase()||window;var b=b.getDialogSize(),c={},d=this.type.substr(1),g=this.offsetX,f=this.offsetY,h=$(a),k=aa(a),e=U(a);a=V(a);switch(d){case "c":c.y=a/2-b.height/2+h;c.x=e/2-b.width/2+k;break;case "t":c.y=h+f;c.x=e/2-b.width/2+k;break;case "r":c.y=a/2-b.height/2+h;c.x=e-b.width+k-g;break;case "b":c.y=a-b.height+h-f;c.x=e/2-b.width/2+k;break;case "l":c.y=a/2-b.height/2+h;
c.x=k+g;break;case "rt":c.y=h+f;c.x=e-b.width+k-g;break;case "rb":c.y=a-b.height+h-f;c.x=e-b.width+k-g;break;case "lt":c.y=h+f;c.x=k+g;break;case "lb":c.y=a-b.height+h-f,c.x=k+g}return c},getPrimaryPosition:function(){return this.type.substr(1,1)},getSecondaryPosition:function(){return this.type.substr(2)},correctType:function(){},correctPosition:function(){}});r({$class:"dialog.position.Custom",$extends:"dialog.position.Abstract",getCoords:function(a){var b=this.dialog;return this.get.call(b.$$callbackContext,
b,a)}});r({$class:"dialog.pointer.Abstract",enabled:null,node:null,correctX:0,correctY:0,$init:function(a,b){J(this,b,!0,!1);this.origCfg=b;this.dialog=a;this.opposite={t:"b",r:"l",b:"t",l:"r"};this.names={t:"top",r:"right",b:"bottom",l:"left"};this.sides={t:["l","r"],r:["t","b"],b:["r","l"],l:["b","t"]};this.enabled=!1!==this.enabled&&b.size?!0:!1},enable:function(){this.enabled||(this.enabled=!0,this.render(),this.dialog.isVisible()&&this.dialog.reposition())},disable:function(){this.enabled&&(this.remove(),
this.enabled=!1,this.dialog.isVisible()&&this.dialog.reposition())},getElem:function(){return this.node},getSize:function(){return this.enabled?this.size:0},setCorrectionOffset:function(a,b){this.correctX=a;this.correctY=b},getCorrectionValue:function(a,b,c){if(!b)return 0;var d=c.substr(0,1);c=c.substr(1,1);var g=this.dialog.getDialogSize(),f=this.width,h="t"==d||"b"==d?"width":"height",k,e;switch(c){case "":e=g[h]/2-f/2;k=-e;break;case "l":k=0;e=g[h]-f/2;break;case "r":k=-(g[h]-f/2),e=0}b=0>b?Math.max(k,
b):Math.min(e,b);return("t"==d||"b"==d)&&"x"==a||("l"==d||"r"==d)&&"y"==a?b:0},getDialogPositionOffset:function(a){var b=(this.detectPointerPosition(a)||"").substr(0,1);a=this.dialog.getPosition().getPrimaryPosition(a);var c={x:0,y:0};if(!this.enabled)return c;b==this.opposite[a]&&(c["t"==b||"b"==b?"y":"x"]="b"==b||"r"==b?-this.size:this.size);return c},detectPointerPosition:function(a){var b;if(this.position&&!a)return E(this.position)?this.position.call(this.dialog.$$callbackContext,this.dialog,
this.origCfg):this.position;b=this.dialog.getPosition().getPrimaryPosition(a);a=this.dialog.getPosition().getSecondaryPosition(a);if(!b)return null;b=this.opposite[b];a&&(a=a.substr(0,1),b+=a);return b},detectPointerDirection:function(a){return this.direction?E(this.direction)?this.direction.call(this.dialog.$$callbackContext,this.dialog,a,this.origCfg):this.direction:a},update:function(){this.remove();this.render();this.append();this.dialog.isVisible()&&this.dialog.reposition()},setType:function(a,
b){this.position=a;this.direction=b;this.update();this.reposition()},render:function(){},destroy:function(){this.remove()},reposition:function(){},append:function(){if(this.enabled&&(this.node||this.render(),this.node)){this.reposition();var a=this.dialog.getElem();a&&a.appendChild(this.node)}},remove:function(){var a=this.node;a&&(a.parentNode&&a.parentNode.removeChild(a),this.node=null)}});var sa=function(){var a=["Moz","Webkit","ms","O","Khtml"],b="animationDelay",c="animationDuration",d="transitionDelay",
g="transitionDuration",f="transform",h=null,k=null,e=!1;return function(){if(!e){var l=window.document.createElement("div"),m=!1,n,p,v;if(void 0!==l.style.animationName)m=!0;else for(p=0,v=a.length;p<v;p++)if(n=a[p],void 0!==l.style[n+"AnimationName"]){m=!0;b=n+"AnimationDelay";c=n+"AnimationDuration";d=n+"TransitionDelay";g=n+"TransitionDuration";f=n+"Transform";break}m&&("ontransitionend"in window?h="transitionend":"onwebkittransitionend"in window&&(h="webkitTransitionEnd"));k=m?{animationDelay:b,
animationDuration:c,transitionDelay:d,transitionDuration:g,transform:f,transitionend:h}:{};e=!0}return k}}();(function(){var a=null,b={backgroundColor:"transparent",width:"0px",height:"0px",position:"absolute",fontSize:"0px",lineHeight:"0px"};return r({$class:"dialog.pointer.Html",$extends:"dialog.pointer.Abstract",node:null,sub:null,$init:function(b,d){null===a&&(a=window.document.all&&!window.XMLHttpRequest);this.$super(b,d);this.width=this.width||2*this.size;this.inner&&(this.enabled=!0)},createInner:function(){var a=
J({},this.origCfg);a.size=this.size-2*this.border;a.width=this.width-4*this.border;a.border=0;a.borderColor=null;a.borderCls=null;a.offset=0;a.inner=this.border;this.sub=N("dialog.pointer.Html",this.dialog,a)},getBorders:function(b,d,g){var f={},h=b.substr(0,1);b=d.substr(0,1);var k=d.substr(1);d=a?"dotted":"solid";var e=this.names,l=this.sides,m=this.opposite;f["border"+F(e[m[h]])]=this.size+"px solid "+g;f["border"+F(e[h])]="0 "+d+" transparent";k?(f["border"+F(e[k])]="0 solid transparent",f["border"+
F(e[m[k]])]=this.width+"px "+d+" transparent"):(g=Math.floor(this.width/2),f["border"+F(e[l[b][0]])]=g+"px "+d+" transparent",f["border"+F(e[l[b][1]])]=g+"px "+d+" transparent");return f},getOffsets:function(a,b){var g={},f=this.names,h=this.opposite,k=a.substr(0,1),e="t"==k||"b"==k?"r":"b";g[f[k]]=this.inner?"auto":-this.size+"px";g[f[e]]="auto";if(this.inner){var k=b.substr(0,1),l=b.substr(1);g[f[h[e]]]=l?"l"==l||"t"==l?this.inner+"px":-this.width-this.inner+"px":Math.floor(-this.width/2)+"px";
g[f[h[k]]]=-(this.size+2*this.inner)+"px"}else{switch(a){case "t":case "r":case "b":case "l":k=b!=a?"l"==b||"t"==b?this.offset:-this.width+this.offset:-this.width/2+this.offset;break;case "bl":case "tl":case "lt":case "rt":k=this.offset;break;default:k=-this.width-this.offset}g["margin"+F(f[h[e]])]=k+"px";switch(a){case "t":case "r":case "b":case "l":k="50%";break;case "tr":case "rb":case "br":case "lb":k="100%";break;default:k=0}g[f[h[e]]]=k;f=sa().transform;h="";e=this.correctX;k=this.correctY;
f&&(e&&(h+=" translateX("+this.getCorrectionValue("x",e,a)+"px)"),k&&(h+=" translateY("+this.getCorrectionValue("y",k,a)+"px)"),g[f]=h)}return g},render:function(){if(this.enabled&&!this.node&&this.detectPointerPosition()){this.border&&!this.sub&&this.createInner();this.node=window.document.createElement("div");var a=window.document.createComment(" ");this.node.appendChild(a);q(this.node,b);H(this.node,this.borderCls||this.cls);this.sub&&(this.sub.render(),this.node.appendChild(this.sub.getElem()))}},
reposition:function(){var a=this.detectPointerPosition(),b=this.detectPointerDirection(a);this.node&&(q(this.node,this.getBorders(a,b,this.borderColor||this.color)),q(this.node,this.getOffsets(a,b)),this.sub&&this.sub.reposition())},update:function(){this.sub&&(this.sub.$destroy(),this.sub=null);this.remove();this.node=null;this.render();this.append();this.dialog.isVisible()&&this.dialog.reposition()},destroy:function(){this.sub&&(this.sub.$destroy(),this.sub=null);this.$super()},remove:function(){this.sub&&
this.sub.remove();this.$super()}})})();r({$class:"dialog.Overlay",dialog:null,enabled:!1,color:"#000",opacity:.5,cls:null,animateShow:!1,animateHide:!1,$init:function(a){this.dialog=a;this.onClickDelegate=w(this.onClick,this);J(this,a.getCfg().overlay,!0,!1);this.enabled&&(this.enabled=!1,this.enable())},getElem:function(){this.enabled&&!this.node&&this.render();return this.node},enable:function(){this.enabled||(this.enabled=!0)},disable:function(){this.enabled&&(this.remove(),this.enabled=!1)},show:function(a){this.enabled&&
(this.animateShow?this.animate("show",a):this.node.style.display="block")},hide:function(a){this.node&&(this.animateHide?this.animate("hide",a):this.node.style.display="none")},render:function(){if(this.enabled){var a=window.document.createElement("div"),b=this.dialog.getCfg();q(a,{display:"none",position:"fixed",left:0,top:0,right:0,bottom:0,opacity:this.opacity,backgroundColor:this.color});A(a,"click",this.onClickDelegate);b.render.zIndex&&q(a,"zIndex",b.render.zIndex);this.cls&&H(a,this.cls);this.node=
a}},remove:function(){var a=this.dialog,b=this.node;b&&G(function(){!a.isVisible()&&b.parentNode&&b.parentNode.removeChild(b)})},append:function(){var a=this.dialog.getCfg().render.appendTo||window.document.body;this.enabled&&(this.node||this.render(),a.appendChild(this.node))},animate:function(a,b){var c=this.node,d;d="show"==a?this.animateShow:this.animateHide;E(d)&&(d=d(this,b));Q(d)?d=a:B(d)&&(d=[d]);return W(c,d,function(){if("show"==a){var b=new ba;G(function(){c.style.display="";b.resolve()});
return b}},!1)},onClick:function(a){return this.modal?(a=y(a),a.preventDefault(),a.stopPropagation(),!1):null},destroy:function(){this.remove()}});r({$class:"dialog.Manager",all:null,groups:null,$init:function(){this.all={};this.groups={}},register:function(a){var b=a.getInstanceId(),c=a.getGroup(),d=this.groups,g,f,h;this.all[b]=a;g=0;for(f=c.length;g<f;g++)h=c[g],d[h]||(d[h]={}),d[h][b]=!0;a.on("destroy",this.unregister,this)},unregister:function(a){a=a.getInstanceId();delete this.all[a]},hideAll:function(a){var b=
a.getInstanceId();a=a.getGroup();var c=this.all,d=this.groups,g,f,h,k;g=0;for(f=a.length;g<f;g++)for(k in h=a[g],h=d[h],h)c[k]?k==b||c[k].isHideAllIgnored()||c[k].hide(null,!0,!0):delete h[k]}});u=function(){var a=N("dialog.Manager"),b=function(a,b,e,c){if("show"==e||!c)return b.preventDefault(),b.stopPropagation(),!1},c=function(a,b,e,c){var d=a[b],f=!1;if(void 0!==d){switch(c){case "string":f=B(d);break;case "function":f=E(d);break;case "number":f=1===P(d)||d==parseInt(d);break;case "dom":f=d&&
(d.tagName||d.nodeName)?!0:!1;break;case "jquery":(f=d&&d.jquery?!0:!1)&&(d=d.get(0));break;case "boolean":if(!0===d||!1===d)f=!0;break;default:!0===c&&!0===d&&(f=!0),!1===c&&!1===d&&(f=!0)}f&&(a[b]={},a[b][e]=d)}},d=function(a){if(!a)return{};c(a,"content","value","string");c(a,"content","value","boolean");c(a,"content","fn","function");c(a,"ajax","url","string");c(a,"cls","dialog","string");c(a,"render","tpl","string");c(a,"render","fn","function");c(a,"render","el","dom");c(a,"render","el","jquery");
c(a,"show","events",!1);c(a,"show","events","string");c(a,"hide","events",!1);c(a,"hide","events","string");c(a,"toggle","events",!1);c(a,"toggle","events","string");c(a,"position","type","string");c(a,"position","type",!1);c(a,"position","get","function");c(a,"overlay","enabled","boolean");c(a,"pointer","position","string");c(a,"pointer","size","number");return a},g={target:null,group:null,modal:!1,useHref:!1,content:{value:"",fn:null,prepare:null,attr:null},ajax:{url:null,data:null,dataType:"text",
method:"GET"},cls:{dialog:null,visible:null,hidden:null,loading:null},selector:{content:null},buttons:null,render:{tpl:"<div></div>",fn:null,el:null,zIndex:null,lazy:!0,style:null,appendTo:null,id:null,keepVisible:!1,keepInDOM:!1,lifetime:null},events:{show:{"*":{process:b}},hide:{"*":{process:b}}},show:{delay:null,single:!1,events:null,animate:!1,ignoreHideAll:!1,focus:!1,preventScroll:!1,display:"block"},hide:{delay:null,timeout:null,events:null,destroy:!1,remove:!1,animate:!1,cancelShowDelay:!0},
toggle:{events:null},position:{type:"t",preferredType:null,offsetX:0,offsetY:0,axis:null,get:null,screenX:!1,screenY:!1,base:null,scroll:!1,resize:!0},pointer:{position:null,direction:null,size:0,width:null,color:null,offset:0,border:0,borderColor:null,el:null,cls:null,borderCls:null},overlay:{enabled:!1,color:"#000",opacity:.5,cls:null,animateShow:!1,animateHide:!1},callback:{scope:null,contentchange:null,beforeshow:null,show:null,beforehide:null,hide:null,render:null,lifetime:null,targetchange:null,
button:null}},f=r({$class:"Dialog",$mixins:["mixin.Observable"],id:null,node:null,overlay:null,pointer:null,cfg:null,position:null,target:null,dynamicTarget:!1,dynamicTargetEl:null,visible:!1,enabled:!0,frozen:!1,rendered:!1,bindSelfOnRender:!1,hideTimeout:null,hideDelay:null,showDelay:null,destroyDelay:null,images:0,positionGetType:null,positionClass:null,positionAttempt:0,$init:function(h){h=h||{};var b=h.preset;h.preset=null;this.cfg=h=J({},g,d(f.defaults),d(f[b]),d(h),!0,!0);this.id=ha();this.onPreventScrollDelegate=
w(this.onPreventScroll,this);this.onButtonClickDelegate=w(this.onButtonClick,this);this.onButtonKeyupDelegate=w(this.onButtonKeyup,this);this.showDelegate=w(this.show,this);this.hideDelegate=w(this.hide,this);this.toggleDelegate=w(this.toggle,this);this.onImageLoadDelegate=w(this.onImageLoad,this);a.register(this);h.modal&&(h.overlay.enabled=!0);this.overlay=N("dialog.Overlay",this);b=F(h.pointer.$class||"Html");this.pointer=N("dialog.pointer."+b,this,h.pointer);E(h.position.type)&&(this.positionGetType=
h.position.type);this.setTarget(h.target);h.target&&h.useHref&&(b=L(this.getTarget(),"href"),"#"==b.substr(0,1)?h.render.el=b:h.ajax.url=b);h.render.lazy||this.render();this.trigger("init",this);this.setHandlers("bind")},getElem:function(){return this.node},getInstanceId:function(){return this.id},getCfg:function(){return this.cfg},getPointer:function(){return this.pointer},getOverlay:function(){return this.overlay},isEnabled:function(){return this.enabled},isVisible:function(){return this.visible},
isHideAllIgnored:function(){return this.cfg.show.ignoreHideAll},isFrozen:function(){return this.frozen},isRendered:function(){return this.rendered},enable:function(){this.enabled=!0},disable:function(){this.hide();this.enabled=!1},freeze:function(){this.frozen=!0},unfreeze:function(){this.frozen=!1},getGroup:function(){var a=this.cfg;return a.group?B(a.group)?[a.group]:a.group:[""]},toggle:function(a,b){return a&&a.stopPropagation&&this.dynamicTarget&&this.visible&&this.isDynamicTargetChanged(a)?
this.show(a):this[this.visible?"hide":"show"](a,b)},resetHandlers:function(a,b){this.setHandlers("unbind");this.bindSelfOnRender=!1;a&&a.call(b,this,this.getCfg());this.setHandlers("bind")},setHandlers:function(a,b){for(var e=this.cfg,c=["show","hide","toggle"],d="bind"==a?A:C,f="bind"==a?la:ma,g,v,s,w,q,y,r,z,u,x;g=c.shift();)if(v=e[g].events,!1!==v){if(B(v)||"object"==typeof v&&5===P(v))this.dynamicTarget?(q={},q[v]=e.target,v={_html:q}):v={_target:v};for(s in v){if(b)if("_self"==b){if("_self"!=
s&&"_overlay"!=s&&">"!=s.substr(0,1))continue}else if(s!=b)continue;if("_self"!=s&&"_overlay"!=s&&">"!=s.substr(0,1)||this.node){if(r=v[s]){switch(s){case "_target":z=[this.getTarget()];break;case "_self":z=[this.node];break;case "_window":z=[window];break;case "_document":z=[window.document];break;case "_html":z=[window.document.documentElement];break;case "_overlay":z=[this.overlay.getElem()];break;default:z=">"==s.substr(0,1)?t(s.substr(1),this.node):t(s)}if(z&&z.length)if(B(r)&&(r=[r]),"object"==
typeof r&&5===P(r))for(q=0,y=r.length;q<y;q++)for(u=-1,x=z.length;++u<x;d(z[u],r[q],this[g+"Delegate"]));else for(w in r)for(u=-1,x=z.length;++u<x;f(z[u],r[w],w,this[g+"Delegate"]));}}else this.bindSelfOnRender=!0}}},onPreventScroll:function(a){y(a).preventDefault()},onButtonClick:function(a){var b=y(a).target;(b=D(b,"metaphorjsTooltip-button-id"))&&this.trigger("button",this,b,a)},onButtonKeyup:function(a){if(13==a.keyCode||32==a.keyCode){var b=D(a.target,"metaphorjsTooltip-button-id");b&&this.trigger("button",
this,b,y(a))}},show:function(h,b){var e=this.cfg,c=null,d=e.show,f=null;this.isEnabled()||(f="disabled");!f&&this.visible&&this.hideTimeout&&(window.clearTimeout(this.hideTimeout),this.hideTimeout=M(this.hide,this,null,e.hide.timeout),f="hidetimeout");!f&&this.hideDelay&&(window.clearTimeout(this.hideDelay),this.hideDelay=null,this.visible=!0,f="hidedelay");!f&&this.frozen&&(f="frozen");this.destroyDelay&&(window.clearTimeout(this.destroyDelay),this.destroyDelay=null);var g=!1;h&&h.stopPropagation&&
this.dynamicTarget&&(g=this.changeDynamicTarget(h));this.visible&&(g?(this.reposition(h),f="reposition"):f=f||"visible");if(!f||g)this.node?g&&this.changeDynamicContent():this.render();f||!1!==this.trigger("before-show",this,h)||(f="beforeshow");h&&h.stopPropagation&&e.events.show&&(e.events.show[h.type]||e.events.show["*"])&&(e=e.events.show[h.type]||e.events.show["*"],e.process?c=e.process(this,h,"show",f):(e.stopPropagation&&h.stopPropagation(),e.preventDefault&&h.preventDefault(),c=e.returnValue));
if(f)return f;ea(this.node);this.visible=!0;d.single&&a.hideAll(this);this.toggleTitleAttribute(!1);d.delay&&!b?this.showDelay=M(this.showAfterDelay,this,[h],d.delay):this.showAfterDelay(h,b);return c},showAfterDelay:function(a,b){var e=this,c=e.cfg;e.showDelay=null;if(e.visible){e.trigger("show-after-delay",e,a);c.hide.remove&&e.appendElem();e.reposition(a);if(c.show.preventScroll){var d=c.show.preventScroll,f,g;!0===d&&(d="body");d=t(d);f=-1;for(g=d.length;++f<g;A(d[f],"mousewheel",e.onPreventScrollDelegate)&&
A(d[f],"touchmove",e.onPreventScrollDelegate));}e.overlay.show();c.show.animate&&!b?e.animate("show").done(function(){e.showAfterAnimation(a)}):G(function(){e.showAfterAnimation(a)})}},showAfterAnimation:function(a){var b=this.cfg,e=this.node;this.visible&&(Y(e,b.cls.hidden),H(e,b.cls.visible),b.render.keepVisible||(e.style.display=b.show.display||"block"),b.hide.timeout&&(this.hideTimeout=M(this.hide,this,null,b.hide.timeout)),b.show.focus&&M(this.setFocus,this,null,20),this.trigger("show",this,
a))},hide:function(a,b,e){var c=null,d=null,f=this.cfg;this.hideTimeout=null;!this.visible&&this.hideDelay&&b&&(window.clearTimeout(this.hideDelay),this.hideDelay=null,this.visible=!0);this.node&&this.visible&&this.isEnabled()||(d=this.node?this.visible?"disabled":"hidden":"noelem");this.showDelay&&!d&&(f.hide.cancelShowDelay||e?(window.clearTimeout(this.showDelay),this.showDelay=null,this.visible=!1,d="cancel"):d="delay");this.frozen&&!d&&(d="frozen");d||!1!==this.trigger("before-hide",this,a)||
(d="beforehide");a&&a.stopPropagation&&f.events.hide&&(f.events.hide[a.type]||f.events.hide["*"])&&(e=f.events.hide[a.type]||f.events.hide["*"],e.process?c=e.process(this,a,"hide",d):(e.stopPropagation&&a.stopPropagation(),e.preventDefault&&a.preventDefault(),c=e.returnValue));if(d)return c;ea(this.node);this.visible=!1;this.toggleTitleAttribute(!0);this.dynamicTarget&&this.resetDynamicTarget();f.hide.delay&&!b?this.hideDelay=M(this.hideAfterDelay,this,[a],f.hide.delay):this.hideAfterDelay(a,b);return c},
hideAfterDelay:function(a,b){var e=this,c=e.cfg;e.hideDelay=null;if(!e.visible){e.trigger("hide-after-delay",e,a);if(c.show.preventScroll){var d=c.show.preventScroll,f,g;!0===d&&(d="body");d=t(d);f=-1;for(g=d.length;++f<g;C(d[f],"mousewheel",e.onPreventScrollDelegate)&&C(d[f],"touchmove",e.onPreventScrollDelegate));}e.overlay.hide();c.hide.animate&&!b?e.animate("hide").done(function(){e.hideAfterAnimation(a)}):G(function(){e.hideAfterAnimation(a)})}},hideAfterAnimation:function(a){var b=this,e=b.cfg,
c=b.node;b.visible||(Y(c,e.cls.visible),H(c,e.cls.hidden),e.render.keepVisible||(c.style.display="none"),b.trigger("hide",b,a),a=e.render.lifetime,null!==a&&(0===a?b.destroyElem():b.destroyDelay=M(b.destroyElem,b,null,a)),c&&e.hide.destroy&&G(function(){D(c,e.instanceName,null);b.destroy()}),c&&e.hide.remove&&G(function(){b.removeElem()}))},render:function(){var a=this.cfg,b;if(!this.node){var e=a.render,c=a.cls;e.fn&&(b=e.fn.call(this.$$callbackContext,this),e[B(b)?"tpl":"el"]=b);e.el?B(e.el)?(b=
t(e.el).shift(),e.keepInDOM=!0):b=e.el:(b=window.document.createElement("div"),b.innerHTML=e.tpl,b=b.firstChild);b||(b=window.document.createElement("div"));this.node=b;e.id&&b.setAttribute("id",e.id);a.render.keepVisible||(b.style.display="none");H(b,c.dialog);H(b,c.hidden);e.style&&q(b,e.style);this.overlay.render();a.hide.remove?b.parentNode&&b.parentNode.removeChild(b):this.appendElem();e.zIndex&&q(b,{zIndex:e.zIndex});e=a.content;if(!1!==e.value)if(e.value)this.setContent(e.value);else if(e.fn)this.setContent(e.fn.call(this.$$callbackContext,
this));else this[a.ajax.url?"loadContent":"readContent"]();this.pointer.render();this.pointer.append();if(a.buttons)for(var d in a.buttons)if(e=t(a.buttons[d],b).shift())D(e,"metaphorjsTooltip-button-id",d),A(e,"click",this.onButtonClickDelegate),A(e,"keyup",this.onButtonKeyupDelegate);this.bindSelfOnRender&&(this.setHandlers("bind","_self"),this.bindSelfOnRender=!1);this.rendered=!0;this.trigger("render",this)}},setPositionType:function(a){var b=this.getPositionClass(a);this.cfg.position.type=a;
this.positionClass==b&&this.position?this.position.type=a:(this.position&&(this.position.$destroy(),this.position=null),b&&(this.position=N(b,this)));this.isVisible()&&this.reposition()},getPosition:function(a){var b=this.cfg.position;if(!this.position){!this.positionGetType&&"custom"!=b.type&&E(b.get)&&"m"!=b.type&&(b.type="custom");a=this.positionGetType?this.positionGetType.call(this.$$callbackContext,this,a):b.type;var c=this.getPositionClass(a);b.type=a;if(!1===c)return;this.positionClass!=c?
this.position=N(this.getPositionClass(a),this):this.position.type=a}return this.position},getPositionClass:function(a){return a?E(a)||"custom"==a?"dialog.position.Custom":(a=a.substr(0,1))?"w"==a?"dialog.position.Window":"m"==a?"dialog.position.Mouse":"dialog.position.Target":!1:!1},reposition:function(a){this.repositioning||(this.repositioning=!0,a&&(a=y(a)),this.getPosition(a),this.trigger("before-reposition",this,a),this.getPosition(a),this.trigger("reposition",this,a),this.repositioning=!1)},
getTarget:function(){return this.dynamicTarget?this.dynamicTargetEl:this.target},setTarget:function(a){if(a){var b=!1,c=this.target;this.target?(this.setHandlers("unbind","_target"),b=!0):this.dynamicTarget&&(b=!0);var d=B(a);d&&"#"!=a.substr(0,1)?(this.dynamicTarget=!0,this.target=null):(d&&(a=t(a).shift()),this.dynamicTarget=!1,this.target=a);b&&(this.setHandlers("bind","_target"),this.trigger("target-change",this,a,c))}},resetDynamicTarget:function(){var a=this.dynamicTargetEl;a&&(this.setHandlers("unbind",
"_target"),this.trigger("target-change",this,null,a))},isDynamicTargetChanged:function(a){var b=this.cfg.target;a=a.target;for(var c=this.dynamicTargetEl;a&&!Z(a,b);)a=a.parentNode;return a?!c||c!==a:!1},changeDynamicTarget:function(a){var b=this.cfg.target;a=a.target;for(var c=this.dynamicTargetEl;a&&!Z(a,b);)a=a.parentNode;if(!a||c&&c===a)return!1;c&&this.setHandlers("unbind","_target");this.dynamicTargetEl=a;this.setHandlers("bind","_target");this.trigger("target-change",this,a,c);return!0},getContentElem:function(){var a=
this.node;return a?this.cfg.selector.content?t(this.cfg.selector.content,a).shift()||a:a:null},setContent:function(a,b){b=b||"";var c=this.node,d=this.cfg,f=this.pointer;if(!c)return d.content.value=a,this;d.content.prepare&&(a=d.content.prepare.call(this.$$callbackContext,this,b,a));var g=this.getContentElem(),p=this.rendered&&!d.selector.content&&f,f=p&&f.getElem();if(p&&f)try{c.removeChild(f)}catch(r){}if(B(a))g.innerHTML=a;else for(var s in a){var q=d.selector[s];q&&(q=t(q,g).shift())&&(q.innerHTML=
a[s])}if(p&&f)try{c.appendChild(f)}catch(u){}c=t("img",g);this.images=c.length;s=-1;for(d=c.length;++s<d;A(c[s],"load",this.onImageLoadDelegate));this.trigger("content-change",this,a,b);this.onContentChange()},readContent:function(){var a=this.cfg,b=this.getTarget(),c;b&&(c=a.content.attr?L(b,a.content.attr):L(b,"tooltip")||L(b,"title")||L(b,"alt"));c&&this.setContent(c,"attribute")},loadContent:function(a){var b=this.cfg;H(this.node,b.cls.loading);a=J({},b.ajax,a,!0,!0);this.trigger("before-ajax",
this,a);return ka(a).done(this.onAjaxLoad,this)},onAjaxLoad:function(a){Y(this.node,this.cfg.cls.loading);this.setContent(a,"ajax")},onImageLoad:function(){this.images--;this.onContentChange()},onContentChange:function(){this.visible&&this.reposition()},changeDynamicContent:function(){var a=this.cfg;a.content.fn?this.setContent(a.content.fn.call(this.$$callbackContext,this)):a.content.attr&&this.readContent()},toggleTitleAttribute:function(a){var b=this.getTarget(),c;b&&(!1===a?(D(b,"tmp-title",L(b,
"title")),b.removeAttribute("title")):(c=D(b,"tmp-title"))&&b.setAttribute("title",c))},getDialogSize:function(){this.rendered||this.render();var a=this.cfg,b=this.node,c=a.cls.hidden?ca(b,a.cls.hidden):!(b&&!(0>=b.offsetWidth||0>=b.offsetHeight)),d=b.style.left;c&&(q(b,{left:"-1000px"}),b.style.display=a.show.display);a={width:U(b),height:V(b)};c&&(q(b,{left:d}),b.style.display="none");return a},getTargetSize:function(){var a=this.getTarget();return a?{width:U(a),height:V(a)}:null},setFocus:function(){var a=
this.cfg,b=a.show.focus,c=this.node,d;if(!0===b)if(b=t("input",c).concat(t("textarea",c)),0<b.length)b[0].focus();else{if(a.buttons)for(d in a.buttons){(a=t(a.buttons[d],c).shift())&&a.focus();break}}else(a=t(b,c).shift())&&a.focus()},getScrollEl:function(a){return!0===a||!1===a?window:"string"==typeof a?t(a).shift():a},animate:function(a,b){var c=this.cfg,d=this.node,f,g;f=c[a].animate;E(f)&&(f=f(this,b));g=f.skipDisplayChange||!1;Q(f)?f=a:B(f)&&(f=[f]);return W(d,f,function(){if("show"==a&&!g){var b=
new ba;G(function(){d.style.display=c.show.display||"block";b.resolve()});return b}},!1)},removeElem:function(){var a=this,b=a.node;a.overlay.remove();b&&b.parentNode&&G(function(){a.visible||b.parentNode.removeChild(b)})},appendElem:function(){var a=window.document.body,a=this.cfg.render.appendTo||a;this.overlay.append();this.node&&a.appendChild(this.node)},destroyElem:function(){var a=this.node;this.setHandlers("unbind","_self");this.bindSelfOnRender=!0;this.pointer.remove();this.overlay.remove();
a&&(this.cfg.render.keepInDOM||a.parentNode.removeChild(a),this.node=null);this.trigger("lifetime",this)},destroy:function(){this.trigger("destroy",this);C(window,"resize",this.onWindowResizeDelegate);C(window,"scroll",this.onWindowScrollDelegate);this.setHandlers("unbind");this.destroyElem();this.overlay&&this.overlay.$destroy();this.pointer&&this.pointer.$destroy();this.position&&this.position.$destroy()}},{defaults:null});return f}();window.jQuery&&(jQuery.fn.metaphorjsTooltip=function(a,b,c){var d=
"dialog",g;"string"==typeof a&&"destroy"!=a&&(g=a,a=b,b=c);a=a||{};d+="-"+(b||"default");this.each(function(){var b=D(this,d);if(b)if("destroy"==a)b.destroy(),D(this,d,null);else throw Error("MetaphorJs tooltip already instantiated for this html element");else a.target=this,a.instanceName=d,a.preset=g,D(this,d,new fa.Dialog(a))})});return u});
